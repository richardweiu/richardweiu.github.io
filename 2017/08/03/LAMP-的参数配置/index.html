<!doctype html>



  


<html class="theme-next pisces use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content=" Apache , PHP ,">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta name="description" content="前言 　很少情况会用用到 apache，一般情况下都习惯使用 Nginx 的反向代理来做转发，这是在初入实验楼的时候 16 年 8 月，重写一门 LAMP 课程后两节的时候去了解的，着重在与 Apache 与 PHP 的一些参数配置。（实验楼课程链接，这本就是我写的，我是算转载的还是算。。。）  Apache 配置以前也用过 apache，但是更多的只是用到其虚拟主机，端口监听的很少一部分功">
<meta name="keywords" content=" Apache , PHP ">
<meta property="og:type" content="article">
<meta property="og:title" content="LAMP 的参数配置">
<meta property="og:url" content="http://richardweiu.github.io/2017/08/03/LAMP-的参数配置/index.html">
<meta property="og:site_name" content="Richardwei Blog">
<meta property="og:description" content="前言 　很少情况会用用到 apache，一般情况下都习惯使用 Nginx 的反向代理来做转发，这是在初入实验楼的时候 16 年 8 月，重写一门 LAMP 课程后两节的时候去了解的，着重在与 Apache 与 PHP 的一些参数配置。（实验楼课程链接，这本就是我写的，我是算转载的还是算。。。）  Apache 配置以前也用过 apache，但是更多的只是用到其虚拟主机，端口监听的很少一部分功">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081471921981672-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081471922118063-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081471922817560-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081471922897985-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081471938196407-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081471938354374-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081471938475485-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081471941359662-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081471941404205-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081471944702489-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081471944938285-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081472009569330-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081472009671487-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081472009671487-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081472011750354-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081472011878080-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081472011878080-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081472012536104-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081472012737755-wm">
<meta property="og:image" content="https://dn-simplecloud.qbox.me/1135081472012303942-wm">
<meta property="og:updated_time" content="2020-08-12T06:58:06.488Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LAMP 的参数配置">
<meta name="twitter:description" content="前言 　很少情况会用用到 apache，一般情况下都习惯使用 Nginx 的反向代理来做转发，这是在初入实验楼的时候 16 年 8 月，重写一门 LAMP 课程后两节的时候去了解的，着重在与 Apache 与 PHP 的一些参数配置。（实验楼课程链接，这本就是我写的，我是算转载的还是算。。。）  Apache 配置以前也用过 apache，但是更多的只是用到其虚拟主机，端口监听的很少一部分功">
<meta name="twitter:image" content="https://dn-simplecloud.qbox.me/1135081471921981672-wm">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://richardweiu.github.io/2017/08/03/LAMP-的参数配置/">





  <title> LAMP 的参数配置 | Richardwei Blog </title>
</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="en">

  










  
  
    
  

  <div id="particles-js" style="position: fixed; width: 100%; height:100%">
		<canvas width="1354" height="113" class="particles-js-canvas-el" style="width: 100%; height: 100%;">
		</canvas>
  </div>
  
  <div class="container one-collumn sidebar-position-left page-post-detail ">

	<div class="headband"></div>
	
    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Richardwei Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>	
	
    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope="" itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://richardweiu.github.io/2017/08/03/LAMP-的参数配置/">

  <span style="display:none" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Richardwei">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Richardwei Blog">
    <span style="display:none" itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Richardwei Blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                LAMP 的参数配置
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-03T22:15:33+08:00">
                2017-08-03
              </time>
            

            

            
          </span>

          
            <span class="post-category">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/运维/" itemprop="url" rel="index">
                    <span itemprop="name"> 运维 </span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2017/08/03/LAMP-的参数配置/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/08/03/LAMP-的参数配置/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p><strong> 前言 </strong><br>　很少情况会用用到 apache，一般情况下都习惯使用 Nginx 的反向代理来做转发，这是在初入实验楼的时候 16 年 8 月，重写一门 LAMP 课程后两节的时候去了解的，着重在与 Apache 与 PHP 的一些参数配置。（实验楼<a href="https://www.shiyanlou.com/courses/94" target="_blank" rel="noopener">课程链接</a>，这本就是我写的，我是算转载的还是算。。。）</p>
</blockquote>
<h2 id="Apache-配置"><a href="#Apache-配置" class="headerlink" title="Apache 配置"></a>Apache 配置</h2><p>以前也用过 apache，但是更多的只是用到其虚拟主机，端口监听的很少一部分功能，而在写课程的时候涉及到这样的一些内容：</p>
<ul>
<li>Apache 一般优化配置</li>
<li>Apache 日志格式配置</li>
<li>Apache 访问控制配置</li>
<li>Apache 虚拟主机配置</li>
</ul>
<h4 id="Apache-一般优化配置"><a href="#Apache-一般优化配置" class="headerlink" title="Apache 一般优化配置"></a>Apache 一般优化配置</h4><p>Apache 的主要配置文件是 <code>/etc/apache2/apache2.conf</code>，与其他的配置文件相同，<code>#</code> 开头的部分为注释，一般在注释中都是一些对配置文件的解说与介绍。</p>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#在注释中我们看到这么一条,指定apache服务器的配置文件存放的根目录。这是默认值</span></span><br><span class="line">ServerRoot <span class="string">"/etc/apache2"</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#超时时间，单位为秒，默认值为300，意思是如果超过300秒仍未收到或者送出数据，则断开连接。</span></span><br><span class="line">Timeout <span class="number">300</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#启用表示允许保持连接，让每次连接可以提出多个请求。建议关闭，因为保持连接会使会话常驻内存，如果连接数目较多则内存耗尽。想 syn flood 与 cc 攻击大多都可以利用这点。</span></span><br><span class="line">KeepAlive On|Off</span><br><span class="line"></span><br><span class="line"><span class="meta">#保持连接最大数。0表示无限数量，推荐的设置为100</span></span><br><span class="line">MaxKeepAliveRequests <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#连续两个请求之间的时间如果超过5秒还未到达，则连接中断。</span></span><br><span class="line">KeepAliveTimeout <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>在配置文件中我们看到了一些环境变量如错误日志文件的位置，运行的用户名等等。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># These need to be set in /etc/apache2/envvars</span></span><br><span class="line">User <span class="variable">$&#123;APACHE_RUN_USER&#125;</span></span><br><span class="line">Group <span class="variable">$&#123;APACHE_RUN_GROUP&#125;</span></span><br><span class="line">ErrorLog <span class="variable">$&#123;APACHE_LOG_DIR&#125;</span>/error.log</span><br></pre></td></tr></table></figure>
<p>通过注释我们可以了解这些环境变量都在 <code>/etc/apache2/envvars</code> 中定义，若是需要修改，我们只需要修改这个文件里的内容，然后重启服务即可生效。</p>
<p>我还可以定义自己站点的配置文件，我们可以通过 <code>Include</code> 选项来让apache 读取。</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Include</span> <span class="regexp">/etc/</span>phpmyadmin<span class="regexp">/apache.conf</span></span><br></pre></td></tr></table></figure>
<h4 id="Apache-日志格式配置"><a href="#Apache-日志格式配置" class="headerlink" title="Apache 日志格式配置"></a>Apache 日志格式配置</h4><p>在这个配置文件中还有一个特别重要的配置选项，那就是日志格式的配置,首先日志的输出是有等级的区别的。</p>
<p>LogLevel记录日志等级有：</p>
<ul>
<li>error 错误情况</li>
<li>warn 警告情况</li>
<li>info 普通信息</li>
<li>debug 出错级别信息</li>
</ul>
<p>在配置文件中默认为 <code>warn</code> 级别：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">LogLevel</span> <span class="literal">warn</span>  <span class="comment">#错误日志记录等级</span></span><br></pre></td></tr></table></figure>
<p>我们还可以自定义 Apache 的日志格式，详细的日志信息能够帮助我们了解服务的状态，以及对 bug 的调试、对问题的分析。</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LogFormat <span class="string">"%v:%p %h %l %u %t \"%r\" %&gt;s %O \"%&#123;Referer&#125;i\" \"%&#123;User-Agent&#125;i\""</span> vhost_combined</span><br><span class="line">LogFormat <span class="string">"%h %l %u %t \"%r\" %&gt;s %O \"%&#123;Referer&#125;i\" \"%&#123;User-Agent&#125;i\""</span> combined</span><br><span class="line">LogFormat <span class="string">"%h %l %u %t \"%r\" %&gt;s %O"</span> common</span><br><span class="line">LogFormat <span class="string">"%&#123;Referer&#125;i -&gt; %U"</span> referer</span><br><span class="line">LogFormat <span class="string">"%&#123;User-agent&#125;i"</span> agent</span><br></pre></td></tr></table></figure>
<p>其中各个选项对应的含义如下：</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>%h</td>
<td>客户端的ip地址或主机名</td>
</tr>
<tr>
<td>%l</td>
<td>由客户端 identd 判断的RFC 1413身份，输出中的符号 “-“ 表示此处信息无效</td>
</tr>
<tr>
<td>%u</td>
<td>认证系统得到的访问该网页的客户端用户名。有认证时才有效，输出中的符号 “-“ 表示此处信息无效</td>
</tr>
<tr>
<td>%t</td>
<td>服务器接收到请求的时间</td>
</tr>
<tr>
<td>“%r”</td>
<td>请求中的首行信息</td>
</tr>
<tr>
<td>%&gt;s</td>
<td>服务器返回给客户端的最终状态的状态码</td>
</tr>
<tr>
<td>%O</td>
<td>发送的自己数，包含报头</td>
</tr>
<tr>
<td>%V</td>
<td>依照UseCanonicalName规范设置得到的服务器名字</td>
</tr>
<tr>
<td>“%{Referer}i”</td>
<td>此项指明了该请求是从被哪个网页提交过来的</td>
</tr>
<tr>
<td>“%{User&#124;Agent}i”</td>
<td>此项是客户浏览器提供的浏览器信息</td>
</tr>
</tbody>
</table>
<p>还有更多的参数可以查看<a href="http://httpd.apache.org/docs/current/mod/mod_log_config.html#logformat" target="_blank" rel="noopener">官方文档</a></p>
<h4 id="Apache-访问控制配置"><a href="#Apache-访问控制配置" class="headerlink" title="Apache 访问控制配置"></a>Apache 访问控制配置</h4><p>在配置文件中我们还看到有 <code>&lt;Directory&gt;</code> <code>&lt;DirectoryMatch&gt;</code> 等等这样的参数，直接在配置文件中进行配置的选项会在整个服务器中生效，如果你希望让某些配置仅对服务器的部分目录或者文件生效，也就是对所做的这部分配置控制在某个作用域范围内，我们便可使用这个配置选项。</p>
<p>我们可以通过这样的一个例子来认识 <directory> 选项的作用。</directory></p>
<p>首先我们将访问文件的根目录更改为从 <code>/var/www/html</code> 改成 <code>/home/shiyanlou</code>。是否还记得我们在上节实验中提到了 apache 的文件根目录的配置选项 <code>DocumentRoot</code>。在新版本的 apache 中将该项移至在单独的虚拟主机选项配置文件中。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#修改80端口的虚拟主机的访问文件根目录。</span></span><br><span class="line">$ sudo vim <span class="regexp">/etc/</span>apache2<span class="regexp">/site-enabled/</span><span class="number">000</span>-default.conf</span><br></pre></td></tr></table></figure>
<p>在该配置文件中修改DocumentRoot，让其访问/home/shiyanlou</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute"><span class="nomarkup">DocumentRoot</span></span> /home/shiyanlou</span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081471921981672-wm" alt="实验楼"></p>
<p>然后保存退出，并重启 apache 服务让其生效。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo<span class="built_in"> service </span>apache2 restart</span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081471922118063-wm" alt="实验楼"></p>
<p>若是在末尾得到 <code>OK</code> 的标志标识成功重启，若是得到 <code>Fail</code> 的标志，表示重启失败，并告诉你失败的原因，有语法错误的文件与行数。</p>
<p>现在我们在次访问 <code>localhost</code>,我们发现我们得到一个 403 的 Forbidden 禁止访问的错误，错误提示：</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">You don't have permission <span class="keyword">to</span> access / <span class="keyword">on</span> this server.</span><br><span class="line"><span class="comment">#你没有权限访问服务器上的 `/` 目录</span></span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081471922817560-wm" alt="实验楼"></p>
<p>可是我们设置的是 <code>/home/shiyanlou</code> 这个目录，为什么说我们没有权限访问 <code>/</code> 目录，我们返回去看我们的主配置文件。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#进入修改主配置文件</span></span><br><span class="line">$ sudo vim <span class="regexp">/etc/</span>apache2<span class="regexp">/apache2.conf</span></span><br></pre></td></tr></table></figure>
<p>在该配置文件的154行左右我们会发现这样的配置项：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;Directory /&gt;</span></span><br><span class="line">        <span class="attribute"><span class="nomarkup">Options</span></span> FollowSymLinks</span><br><span class="line">        <span class="attribute">AllowOverride</span> None</span><br><span class="line">        <span class="attribute">Require</span> <span class="literal">all</span> denied</span><br><span class="line"><span class="section">&lt;/Directory&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081471922897985-wm" alt="实验楼"></p>
<p>该配置项也就是上文我们所提到的添加一些配置项但是只对部分的目录或者文件生效，而 <code>&lt;Directory&gt;</code> 的意思便是对部分的目录做出配置，它的语法格式是：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Directory</span> 生效的目录路径&gt;</span></span><br><span class="line">		需要做的配置</span><br><span class="line"><span class="tag">&lt;/<span class="name">Directory</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>由上文我们可以了解到，在默认的配置文件中是对系统的根目录做了配置，而 <code>/home/shiyanlou</code> 也在 <code>/</code> 目录中，所以也被限制住了。</p>
<p>而在对根目录中所做的配置有哪些呢，其中我们可以看到有 <code>Options</code>、<code>AllowOverride</code>、<code>Require</code> 选项。</p>
<p><code>Options</code> 是指定一些参数，而常用的参数有这些：</p>
<ul>
<li>None:不支持任何选项。</li>
<li>Indexes：允许文件索引，意思所有的文件以索引的形式在网页上呈现。</li>
<li>FollowSynLinks： 允许符号链接指向的源文件。</li>
<li>Includes： 允许执行服务器包含（ssi）。</li>
<li>ExecCGI：允许执行CGI脚本。</li>
</ul>
<p><code>AllowOverride</code> 是指确定允许存在于 <code>.htaccess</code> 文件中的指令类型。通常利用 Apache 的 rewrite 模块对 URL 进行重写的时候， rewrite 规则会写在 .htaccess 文件里。一般设置为 <code>None</code> 来保证网站的安全性。</p>
<p><code>Require</code> 是对资源的访问控制的参数，还可以与 <code>AuthName</code> 等类型的参数配合来使得部分目录只能通过某些用户登录来访问。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#该目录无条件允许访问</span></span><br><span class="line"><span class="attribute">Require</span> <span class="literal">all</span> granted</span><br><span class="line"></span><br><span class="line"><span class="comment">#该目录无条件拒绝访问</span></span><br><span class="line"><span class="attribute">Require</span> <span class="literal">all</span> denied</span><br></pre></td></tr></table></figure>
<p>而反观我们的默认配置文件中 <code>/</code> 目录是无条件拒绝访问的，所以我们之前就曝出没有权限访问的错误，我们只需要单独问 <code>/home/shiyanlou</code> 目录配置一下给予权限访问即可。</p>
<p>我们在配置文件中添加这么几行来允许我们当前设置的 DocumentRoot 可以访问。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;Directory /home/shiyanlou&gt;</span></span><br><span class="line">		<span class="attribute">AllowOverride</span> None</span><br><span class="line">		<span class="attribute">Require</span> <span class="literal">all</span> denied</span><br><span class="line"><span class="section">&lt;/Directory&gt;</span></span><br></pre></td></tr></table></figure>
<p>若是只是这样的话你会发现和之前是一样的报错，这是因为在该目录下没有 <code>index.html</code> 这样的索引网页文件，所以我们该目录下添加这样一个文件即可访问了。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">vim</span> /home/shiyanlou/<span class="built_in">index</span>.html</span><br></pre></td></tr></table></figure>
<p>该文件内容为：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">hello shiyanlou</span></span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081471938196407-wm" alt="实验楼"></p>
<p>但是我们若是想要读取里面的其他文件的话，我们可以修改成这样，并且删除 index.html 这个文件。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">vim</span> /etc/apache2/apache2.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure>
<p>修改的内容为：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;Directory /home/shiyanlou&gt;</span></span><br><span class="line">		<span class="attribute"><span class="nomarkup">Options</span></span> Indexes FollowSymLinks</span><br><span class="line">		<span class="attribute">AllowOverride</span> None</span><br><span class="line">		<span class="attribute">Require</span> <span class="literal">all</span> denied</span><br><span class="line"><span class="section">&lt;/Directory&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081471938354374-wm" alt="实验楼"></p>
<p>并且重启下我们的 apache 来使得配置文件生效：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ rm -rf index.html</span><br><span class="line"></span><br><span class="line">$ sudo<span class="built_in"> service </span>apache2 restart</span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081471938475485-wm" alt="实验楼"></p>
<p>若是遇到某些敏感的文件，不适合允许所有的人随意的访问，我们还可以使用 <code>require</code> 参数来限制只允许某些 ip 访问，修改之后记得重启 apache2 服务哦。</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Require<span class="built_in"> ip </span>这里填写ip地址范围</span><br><span class="line"></span><br><span class="line"><span class="comment">#例如，允许192.168.0.0这里面的所有网段都可以访问</span></span><br><span class="line">Require<span class="built_in"> ip </span>192.168</span><br><span class="line"></span><br><span class="line"><span class="comment">#但是允许本地的话比较特殊可以使用这两种方法中的一种</span></span><br><span class="line">Require local</span><br><span class="line"><span class="comment">#或者是</span></span><br><span class="line">Require<span class="built_in"> ip </span>localhost</span><br><span class="line">Require ::1</span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081471941359662-wm" alt="实验楼"></p>
<p><img src="https://dn-simplecloud.qbox.me/1135081471941404205-wm" alt="实验楼"></p>
<p>还有很多高级的用法，如上文提到的设置用户认证登陆等等，有兴趣深入学习可以多看看<a href="http://httpd.apache.org/docs/current/mod/mod_authz_core.html#require" target="_blank" rel="noopener">官方文档</a>。</p>
<p>与之类似的还有一个参数 <code>Order</code> 也可以做到访问控制的功能，但是只能在 IP 或者域名的层次上做限制，无法像 <code>Require</code> 那样做到控制用户访问。当然他们可以配合着使用也很强大。</p>
<p><code>Order</code> 的用法类似于 <code>tcp wrappers</code>，依靠 <code>allow</code>、<code>deny</code> 来做访问的控制。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#格式如下，allow与deny 位置没有要求，但是 `order` 后面谁放在前面谁的规则就先生效</span></span><br><span class="line"><span class="attribute"><span class="nomarkup">Order</span></span> Allow,Deny</span><br><span class="line"><span class="comment">#allow的具体白名单</span></span><br><span class="line"><span class="attribute"><span class="nomarkup">Allow</span></span> from <span class="literal">all</span>(或者ip)</span><br><span class="line"><span class="comment">#deny的具体黑名单</span></span><br><span class="line"><span class="attribute"><span class="nomarkup">Deny</span></span> from <span class="literal">all</span>（或者ip）</span><br></pre></td></tr></table></figure>
<p><code>Order</code> 后面跟的 <code>Allow</code> 与 <code>Deny</code> 的顺序的两个作用：</p>
<ul>
<li>哪个参数放在前面那个参数的规则便先生效，比如 <code>Order Allow,Deny</code> 的话则 allow 的规则先生效，deny的规则后生效，其实他们的谁先生效并不会有什么影响</li>
<li>在缺省的情况下（也就是没有Allow from与Deny from的具体内容的话），谁在后面的话，默认拒绝或者生效所有，比如 <code>Order Allow,Deny</code> 的话便会拒绝所有，反之的话，则允许所有</li>
</ul>
<p>我们可以在 <code>/home/shiyanlou/Code</code> 上做实验，在配置文件中添加这样的代码。</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;Directory /home/shiyanlou/Code&gt;</span></span><br><span class="line">        <span class="attribute"><span class="nomarkup">Options</span></span> Indexes FollowSymLinks</span><br><span class="line">        <span class="attribute">AllowOverride</span> None</span><br><span class="line">        <span class="attribute"><span class="nomarkup">Order</span></span> Deny,Allow</span><br><span class="line">        <span class="attribute"><span class="nomarkup">Deny</span></span> from localhost</span><br><span class="line"><span class="section">&lt;/Directory&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081471944702489-wm" alt="实验楼"></p>
<p>然后重启服务，让其生效之后我们可以看到这样的效果：</p>
<p><img src="https://dn-simplecloud.qbox.me/1135081471944938285-wm" alt="实验楼"></p>
<p>与 <code>&lt;Directory&gt;</code> 类似的但是侧重点不同的参数还有 <code>&lt;DirectoryMatch&gt;</code>、<code>&lt;Files&gt;</code>、<code>&lt;FilesMatch&gt;</code>、<code>&lt;Location&gt;</code>、<code>&lt;LocationMatch&gt;</code> 这些功能将不再一一列举，有兴趣的同学可以看看官方文档<a href="http://httpd.apache.org/docs/current/mod/core.html#directory" target="_blank" rel="noopener">http://httpd.apache.org/docs/current/mod/core.html#directory</a>。</p>
<h4 id="Apache-虚拟主机配置"><a href="#Apache-虚拟主机配置" class="headerlink" title="Apache 虚拟主机配置"></a>Apache 虚拟主机配置</h4><p>在 apache 还有一个很重要的配置，便是其虚拟主机的配置。</p>
<p>apache 为我们提供了一个网站运行平台，若是在一个物理主机上只有一个网站，我们称之为中心站点，若是我们需要在一台物理主机上运行多个网站（站点）的话，这时候我们就需要使用虚拟主机。</p>
<p>从上文我们可以体会到一个网站（站点）主要是访问 DocumentRoot 目录下的文件或者程序，而虚拟主机只要让用户访问不同的 DocumentRoot 即可，用户也不会感受到这是一台主机。</p>
<p>而虚拟主机的用处主要用于一些访问量不大，功能简单，不会消耗太多资源的展示类网站，这样我们就不需要多一台物理主机，消耗成本了。</p>
<p>虚拟主机主要有三种方式：</p>
<ul>
<li>基于 IP 地址的虚拟主机</li>
<li>基于端口的虚拟主机</li>
<li>基于域名的虚拟主机</li>
</ul>
<p>基于IP的虚拟主机用于当我们有多的 IP 地址资源的时候，比如我们有多张网卡的时候，或者设置网卡别名都可以的（网卡别名在本实验环境中无法实现）。</p>
<p>在本实验环境中我们可以做这样的一个时间，我们用 <code>ifconfig</code> 命令可以看到我们有两张网卡，一个是 <code>lo</code> 本地的回环网卡以及对外通信的 <code>eth0</code> 网卡。</p>
<p>接下来我们针对这两个网卡的 <code>ip</code> 地址做这样的实验：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置站点虚拟主机的配置文件</span></span><br><span class="line">sudo vim <span class="regexp">/etc/</span>apache<span class="regexp">/site-enable/</span><span class="number">000</span>-default.conf</span><br></pre></td></tr></table></figure>
<p>在这个配置文件中我们增加这样的一些内容（因为这个方式比较取巧，所以我们的把 eth0 的地址配置放在上面），记住这里的 <code>eth0</code> 的 ip 地址是我电脑上的，你们需要填写自己的 eth0 的 ip 地址。</p>
<p>比如这样的设置：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;VirtualHost 192.168.42.2:80&gt;</span></span><br><span class="line">    <span class="attribute"><span class="nomarkup">DocumentRoot</span></span> /home/shiyanlou</span><br><span class="line"><span class="section">&lt;/VirtualHost&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="section">&lt;VirtualHost 127.0.0.1:80&gt;</span></span><br><span class="line">    <span class="attribute"><span class="nomarkup">DocumentRoot</span></span> /var/www/html</span><br><span class="line"><span class="section">&lt;/VirtualHost&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081472009569330-wm" alt="实验楼"></p>
<p>当然这样的前提是在上面的小例子的基础上，也就是添加了 <code>/home/shiyanlou</code> 的访问权限的。</p>
<p><img src="https://dn-simplecloud.qbox.me/1135081472009671487-wm" alt="实验楼"></p>
<p>配置完成之后我们重启 apache 服务，再试试访问 <code>192.168.42.2</code> 与 <code>127.0.0.1</code> 这两个地址的效果。</p>
<p><img src="https://dn-simplecloud.qbox.me/1135081472009671487-wm" alt="实验楼"></p>
<p>这便是基于 ip 地址的不同通过虚拟主机来实现两个站点。</p>
<p>除了基于 IP 的不同，我们还可以基于端口的不同来实现两个站点，针对端口的不同无非就是监听两个不同的端口，做出不同的响应。</p>
<p>首先我们需要在 port 的配置文件中添加对新端口的监听:</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="keyword">vim</span> /etc/apache2/ports.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#添加新的端口监听</span></span><br><span class="line"><span class="attribute"><span class="nomarkup">Listen</span></span> 8080</span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081472011750354-wm" alt="实验楼"></p>
<p>接下来便是对虚拟主机的配置了:</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置站点虚拟主机的配置文件</span></span><br><span class="line">sudo vim <span class="regexp">/etc/</span>apache<span class="regexp">/site-enable/</span><span class="number">000</span>-default.conf</span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#添加这样的一些内容</span></span><br><span class="line"><span class="section">&lt;VirtualHost *:8080&gt;</span></span><br><span class="line">    <span class="attribute"><span class="nomarkup">DocumentRoot</span></span> /home/shiyanlou</span><br><span class="line"><span class="section">&lt;/VirtualHost&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="section">&lt;VirtualHost *:80&gt;</span></span><br><span class="line">    <span class="attribute"><span class="nomarkup">DocumentRoot</span></span> /var/www/html</span><br><span class="line"><span class="section">&lt;/VirtualHost&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081472011878080-wm" alt="实验楼"></p>
<p>然后我们保存配置，重启 apache 服务，在分别来访问 <code>127.0.0.1:80</code> 与 <code>127.0.0.1:8080</code> 这两个地址，可以得到这样我们所预期的结果：</p>
<p><img src="https://dn-simplecloud.qbox.me/1135081472011878080-wm" alt="实验楼"></p>
<p>除了以上的两种方式我们还可基于域名来做虚拟主机的配置，同样我们需要对我们的站点配置文件做这样的修改。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置站点虚拟主机的配置文件</span></span><br><span class="line">sudo vim <span class="regexp">/etc/</span>apache<span class="regexp">/site-enable/</span><span class="number">000</span>-default.conf</span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#这是修改的内容</span></span><br><span class="line"><span class="section">&lt;VirtualHost *:80&gt;</span></span><br><span class="line">    <span class="attribute"><span class="nomarkup">DocumentRoot</span></span> /home/shiyanlou</span><br><span class="line">    <span class="attribute"><span class="nomarkup">ServerName</span></span> www.shiyanlou1.com</span><br><span class="line">    </span><br><span class="line"><span class="section">&lt;/VirtualHost&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="section">&lt;VirtualHost *:80&gt;</span></span><br><span class="line">    <span class="attribute"><span class="nomarkup">DocumentRoot</span></span> /var/www/html</span><br><span class="line">    <span class="attribute"><span class="nomarkup">ServerName</span></span> www.shiyanlou1.com</span><br><span class="line"><span class="section">&lt;/VirtualHost&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081472012536104-wm" alt="实验楼"></p>
<p>当然这样的域名是不存在的，我们需要在 hosts 文件中添加该域名的地址映射。</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#修改 hosts 文件</span></span><br><span class="line">sudo vim <span class="regexp">/etc/</span>hosts</span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#添加的内容，同样这里的<span class="selector-tag">ip</span>地址应该是你们自己的<span class="selector-tag">ip</span>地址</span><br><span class="line">192<span class="selector-class">.168</span><span class="selector-class">.42</span><span class="selector-class">.2</span> <span class="selector-tag">www</span><span class="selector-class">.shiyanlou1</span><span class="selector-class">.com</span></span><br><span class="line">192<span class="selector-class">.168</span><span class="selector-class">.42</span><span class="selector-class">.2</span> <span class="selector-tag">www</span><span class="selector-class">.shiyanlou1</span><span class="selector-class">.com</span></span><br></pre></td></tr></table></figure>
<p><img src="https://dn-simplecloud.qbox.me/1135081472012737755-wm" alt="实验楼"></p>
<p>同样完成之后我们需要重启 apache 服务，我们可以得到这样的效果：</p>
<p><img src="https://dn-simplecloud.qbox.me/1135081472012303942-wm" alt="实验楼"></p>
<h2 id="PHP-配置参数"><a href="#PHP-配置参数" class="headerlink" title="PHP 配置参数"></a>PHP 配置参数</h2><p>PHP 的配置文件在 <code>/etc/php5/</code> 中，并且使用 <code>apt-get</code> 装的话，针对的模块不同，配置文件也不同，我们可以看见在该目录下有这样几个文件夹:</p>
<ul>
<li>apache2：专门针对在 apache 调用 php5 时使用的配置文件</li>
<li>cli：专门针对在 shell 调用 php5 时使用的配置文件</li>
<li>fpm: 专门针对在 FastCGI process manager对 php 使用时的配置文件</li>
<li>mods-available: 专门针对在其他程序模块中的配置</li>
</ul>
<p>并且我们还可以在每个文件夹下面看见 php.ini 文件与 conf.d 文件夹。由此我们可以得知 php 的配置文件氛围两部分：</p>
<ul>
<li>php.ini 这个主要的配置文件；</li>
<li>conf.d 这个文件夹下面的配置文件是额外的配置文件，配置某个扩展的配置文件。</li>
</ul>
<p>进入该文件中，其实配置文件的语法很简单：</p>
<ul>
<li>空白字符(” “,”/t”,…)和用分号(”;”)开始的行被简单地忽略；</li>
<li>章节标题（例如 : [php]）也被简单地忽略，即使将来它们可能有意义；</li>
<li>设置格式： directive（指令大小写敏感） = value（值）。</li>
</ul>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###常用的配置</span></span><br><span class="line">    <span class="attr">engine</span> = On //允许 php 引擎在 apache 中运行</span><br><span class="line">    <span class="attr">short_open_tag</span> = Off  <span class="comment">#tags识别</span></span><br><span class="line">    <span class="attr">asp_tags</span> = Off <span class="comment">#asp tags识别</span></span><br><span class="line">    <span class="attr">precision</span> = <span class="number">14</span>  <span class="comment">#浮点类型数显示时的有效位数</span></span><br><span class="line">    <span class="attr">output_buffering</span> = <span class="number">4096</span>   <span class="comment">#输出缓存允许你在输出正文内容之后发送 header</span></span><br><span class="line">    <span class="attr">implicit_flush</span> = Off   <span class="comment">#告诉输出层在每个输出块之后自动刷新自身数据</span></span><br><span class="line">    <span class="attr">disable_functions</span> =    <span class="comment">#关闭特定函数</span></span><br><span class="line">    <span class="attr">display_errors</span> = Off   <span class="comment">#显示错误信息</span></span><br><span class="line">    <span class="attr">log_errors</span> = On        <span class="comment">#在日志文件里记录错误</span></span><br><span class="line">    <span class="attr">request_order</span> = <span class="string">"GP"</span>   <span class="comment">#GET POST</span></span><br><span class="line">    <span class="attr">register_argc_argv</span> = On <span class="comment">#是否声明 argv和argc 变量</span></span><br><span class="line">    <span class="attr">post_max_size</span> = <span class="number">8</span>M     <span class="comment">#最大POST大小</span></span><br><span class="line">    <span class="attr">file_uploads</span> = On      <span class="comment">#是否允许HTTP方式文件上载 </span></span><br><span class="line">	<span class="attr">upload_tmp_dir</span> =       <span class="comment">#用于HTTP上载的文件的临时目录</span></span><br><span class="line">	<span class="attr">upload_max_filesize</span> = <span class="number">2</span>M   <span class="comment">#上载文件的最大大小</span></span><br><span class="line">	<span class="attr">max_file_uploads</span> = <span class="number">20</span>      <span class="comment">#每次最大上传文件个数</span></span><br><span class="line">	<span class="attr">allow_url_fopen</span> = On   <span class="comment">#是否允许把URLs当作http:.. 或把文件当作ftp:...</span></span><br><span class="line">	<span class="attr">default_socket_timeout</span> = <span class="number">60</span>  <span class="comment">#默认socker超时时间</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#MySQL相关</span></span><br><span class="line">    mysql.<span class="attr">allow_persistent</span> = On <span class="comment">#允许持久连接</span></span><br><span class="line">    mysql.<span class="attr">cache_size</span> = <span class="number">2000</span>  <span class="comment">#缓存大小</span></span><br><span class="line">    mysql.<span class="attr">max_persistent</span> = -<span class="number">1</span>  <span class="comment">#持久连接的最大数目 -1不限制</span></span><br><span class="line">    mysql.<span class="attr">max_links</span> = -<span class="number">1</span>  <span class="comment">#最大链接 </span></span><br><span class="line">    mysql.<span class="attr">connect_timeout</span> = <span class="number">60</span>  <span class="comment">#连接超时时间</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#session相关</span></span><br><span class="line">	session.<span class="attr">save_handler</span> = files <span class="comment">#用于保存/取回数据的控制方式</span></span><br><span class="line">	session.<span class="attr">use_cookies</span> = <span class="number">1</span> <span class="comment">#是否使用cookies</span></span><br><span class="line">	session.<span class="attr">name</span> = PHPSESSID  <span class="comment">#设置cookies名</span></span><br><span class="line">	session.<span class="attr">use_only_cookies</span> = <span class="number">1</span>  <span class="comment">#强制SESSION ID必须以COOKIE传递</span></span><br><span class="line">	session.<span class="attr">auto_start</span> = <span class="number">0</span>  <span class="comment">#在请求启动时初始化session </span></span><br><span class="line">	session.<span class="attr">cookie_lifetime</span> = <span class="number">0</span>  <span class="comment">#cookies保持时间</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">#session垃圾回收参数</span></span><br><span class="line">	session.<span class="attr">gc_probability</span> = <span class="number">1</span> <span class="comment">#按百分比整理</span></span><br><span class="line">	session.<span class="attr">gc_divisor</span> = <span class="number">1000</span>  <span class="comment">#每次请求时有1/1000的机会启动"垃圾回收"进程</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">#Session ID传递参数</span></span><br><span class="line">	session.<span class="attr">use_trans_sid</span> = <span class="number">0</span> <span class="comment">#使用URL的方式传递session id</span></span><br><span class="line">	session.<span class="attr">hash_function</span> = <span class="number">0</span> <span class="comment">#生成SID MD5算法</span></span><br><span class="line">	session.<span class="attr">hash_bits_per_character</span> = <span class="number">5</span>  <span class="comment">#指定在SID字符串中的每个字符内保存多少bit</span></span><br></pre></td></tr></table></figure>
<p>在课程中还简单介绍了一些 mysql 的调优参数，准备有空拿一个章节来总结 mysql 的所有配置参数，简单命令，数据引擎等等。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li>apache logformat:<a href="http://httpd.apache.org/docs/current/mod/mod_log_config.html#logformat" target="_blank" rel="noopener">http://httpd.apache.org/docs/current/mod/mod_log_config.html#logformat</a></li>
<li>apcache dirctory:<a href="http://httpd.apache.org/docs/current/mod/core.html#directory" target="_blank" rel="noopener">http://httpd.apache.org/docs/current/mod/core.html#directory</a></li>
</ul>
<p>PHP配置相关链接：</p>
<ul>
<li>PHP中文手册  <a href="http://php.net/manual/zh/" target="_blank" rel="noopener">http://php.net/manual/zh/</a></li>
<li>完整php.ini 参数详解   <a href="http://php.net/manual/zh/ini.php" target="_blank" rel="noopener">http://php.net/manual/zh/ini.php</a></li>
</ul>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Apache/" rel="tag">#  Apache </a>
          
            <a href="/tags/PHP/" rel="tag">#  PHP </a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/08/03/sudo-无法使用/" rel="next" title="sudo 无法使用">
                <i class="fa fa-chevron-left"></i> sudo 无法使用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/10/13/AWK-的使用/" rel="prev" title="AWK 的使用（楼赛答案）">
                AWK 的使用（楼赛答案） <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
					
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Richardwei">
          <p class="site-author-name" itemprop="name">Richardwei</p>
          <p class="site-description motion-element" itemprop="description">updata self everyday</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">50</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">33</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Apache-配置"><span class="nav-number">1.</span> <span class="nav-text">Apache 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Apache-一般优化配置"><span class="nav-number">1.0.1.</span> <span class="nav-text">Apache 一般优化配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Apache-日志格式配置"><span class="nav-number">1.0.2.</span> <span class="nav-text">Apache 日志格式配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Apache-访问控制配置"><span class="nav-number">1.0.3.</span> <span class="nav-text">Apache 访问控制配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Apache-虚拟主机配置"><span class="nav-number">1.0.4.</span> <span class="nav-text">Apache 虚拟主机配置</span></a></li></ol></li></ol><li class="nav-item nav-level-2"><a class="nav-link" href="#PHP-配置参数"><span class="nav-number">2.</span> <span class="nav-text">PHP 配置参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考"><span class="nav-number">3.</span> <span class="nav-text">参考</span></a></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

        
        <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
        <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
        <div class="widget-wrap">
            <!-- <h3 class="widget-title">Tag Cloud</h3> -->
            <div id="myCanvasContainer" class="widget tagcloud">
                <canvas width="250" height="250" id="resCanvas" style="width=100%">
                    <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AWS/"> AWS </a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apache/"> Apache </a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ELK/"> ELK </a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/"> Git </a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jenkins/"> Jenkins </a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/"> Linux </a><span class="tag-list-count">16</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/"> Mac </a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nagios/"> Nagios </a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/"> Nginx </a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/"> PHP </a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Protobuf/"> Protobuf </a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/"> Python </a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSH/"> SSH </a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tidb/"> Tidb </a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/"> Ubuntu </a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/"> blog </a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch/"> elasticsearch </a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ntopng/"> ntopng </a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pptp/"> pptp </a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sentry/"> sentry </a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zsh/"> zsh </a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Celery/">Celery</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Centos/">Centos</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Centos7/">Centos7</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cisco/">Cisco</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Django/">Django</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GNS3/">GNS3</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Postgresql/">Postgresql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/">Redis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/awk/">awk</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/systemd/">systemd</a><span class="tag-list-count">1</span></li></ul>
                </canvas>
            </div>
        </div>
        




    </div>
  </aside>


        
      </div>
	  

    </main>
	
    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Richardwei</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
	
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'richardweiu';
      var disqus_identifier = '2017/08/03/LAMP-的参数配置/';

      var disqus_title = "LAMP 的参数配置";


      function run_disqus_script(disqus_script) {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');

      
        var disqus_config = function () {
            this.page.url = disqus_url;
            this.page.identifier = disqus_identifier;
            this.page.title = disqus_title;
        };
        run_disqus_script('embed.js');
      

    </script>
  





  
  

  

  

  

  

	<script src="/js/src/particles.js"></script>
	<script src="/js/src/app.js"></script>
</body>
  
</html>

